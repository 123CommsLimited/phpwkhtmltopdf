<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="PHP WkHtmlToPdf : A slim PHP wrapper around wkhtmltopdf with an easy to use and clean OOP interface" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>PHP WkHtmlToPdf</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mikehaertl/phpwkhtmltopdf">View on GitHub</a>

          <h1 id="project_title">PHP WkHtmlToPdf</h1>
          <h2 id="project_tagline">A slim PHP wrapper around wkhtmltopdf with an easy to use and clean OOP interface</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mikehaertl/phpwkhtmltopdf/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mikehaertl/phpwkhtmltopdf/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>PHP WkHtmlToPdf provides a simple and clean interface to ease PDF creation with <a href="http://code.google.com/p/wkhtmltopdf/">wkhtmltopdf</a>.
<strong>The <a href="http://code.google.com/p/wkhtmltopdf/">wkhtmltopdf</a> binary must be installed and working on your system.</strong> The static
binary is preferred but this class should also work with the non static version,
even though a lot of features will be missing. You can also use <code>composer</code> to install the binaries from <code>h4cc/wkhtmltopdf-i386</code> or <code>h4cc/wkhtmltopdf-amd64</code>.</p>

<p>This project was sponsored by <a href="http://www.peopleperhour.com">PeoplePerHour</a>.</p>

<h2>
<a name="basic-use" class="anchor" href="#basic-use"><span class="octicon octicon-link"></span></a>Basic use</h2>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">require_once</span><span class="p">(</span><span class="s1">'WkHtmlToPdf.php'</span><span class="p">);</span>

<span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WkHtmlToPdf</span><span class="p">;</span>

<span class="c1">// Add a HTML file, a HTML string or a page from a URL</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addPage</span><span class="p">(</span><span class="s1">'/home/joe/page.html'</span><span class="p">);</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addPage</span><span class="p">(</span><span class="s1">'&lt;html&gt;....&lt;/html&gt;'</span><span class="p">);</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addPage</span><span class="p">(</span><span class="s1">'http://google.com'</span><span class="p">);</span>

<span class="c1">// Add a cover (same sources as above are possible)</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addCover</span><span class="p">(</span><span class="s1">'mycover.html'</span><span class="p">);</span>

<span class="c1">// Add a Table of contents</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addToc</span><span class="p">();</span>

<span class="c1">// Save the PDF</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">saveAs</span><span class="p">(</span><span class="s1">'/tmp/new.pdf'</span><span class="p">);</span>

<span class="c1">// ... or send to client for inline display</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>

<span class="c1">// ... or send to client as file download</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="s1">'test.pdf'</span><span class="p">);</span>
</pre></div>

<h2>
<a name="setting-options" class="anchor" href="#setting-options"><span class="octicon octicon-link"></span></a>Setting options</h2>

<p>The wkhtmltopdf binary knows different types of options (please see <code>wkhtmltopdf -H</code>):                                      </p>

<ul>
<li>global options (e.g. to set the document's DPI)<br>
</li>
<li>page options (e.g. to supply a custom CSS file for a page)<br>
</li>
<li>toc options (e.g. to set a TOC header)<br>
</li>
</ul><p>In addition <code>phpwkhtmltopdf</code> also supports global page options: You can set default page options that will be applied to every page you add. You can also override these defaults per page:</p>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WkHtmlToPdf</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>   <span class="c1">// Set global PDF options</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">setOptions</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>         <span class="c1">// Set global PDF options (alternative)</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">setPageOptions</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>     <span class="c1">// Set default page options</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addPage</span><span class="p">(</span><span class="nv">$page</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>     <span class="c1">// Add page with options (overrides default page options)</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addCover</span><span class="p">(</span><span class="nv">$page</span><span class="p">,</span> <span class="nv">$options</span><span class="p">);</span>    <span class="c1">// Add cover with options (overrides default page options)</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addToc</span><span class="p">(</span><span class="nv">$options</span><span class="p">);</span>             <span class="c1">// Add TOC with options</span>
</pre></div>

<h2>
<a name="special-global-options" class="anchor" href="#special-global-options"><span class="octicon octicon-link"></span></a>Special global options</h2>

<ul>
<li>
<code>binPath</code>: Full path to the wkhtmltopdf binary. Required on Windows systems and optionally autodetected if not set on other OS.</li>
<li>
<code>binName</code>: Base name of the binary to use for autodetection. Default is <code>wkhtmltopdf</code>.</li>
<li>
<code>tmp</code>: Path to tmp directory. Defaults to the PHP temp dir.</li>
<li>
<code>enableEscaping</code>: Whether arguments to wkhtmltopdf should be escaped. Default is true. </li>
<li>
<code>version9</code>: Whether to use command line syntax for wkhtmltopdf &lt; 0.10.</li>
<li>
<code>procEnv</code>: Optional array with environment variables for the <code>proc_open()</code> call.</li>
</ul><p>If you installed <code>wkhtmltopdf</code> via composer, you have to set the <code>bin</code> path to the right binary:</p>

<div class="highlight highlight-php"><pre><span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WkHtmlToPdf</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// Use `wkhtmltopdf-i386` or `wkhtmltopdf-amd64`</span>
    <span class="s1">'binPath'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/vendor/bin/wkhtmltopdf-i386'</span>
<span class="p">));</span>
</pre></div>

<h2>
<a name="error-handling" class="anchor" href="#error-handling"><span class="octicon octicon-link"></span></a>Error handling</h2>

<p><code>saveAs()</code> and <code>save()</code> will return false on error. In this case the detailed error message from wkhtmltopdf can be obtained through <code>getError()</code>:</p>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">())</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">'Could not create PDF: '</span><span class="o">.</span><span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">getError</span><span class="p">());</span>
</pre></div>

<h2>
<a name="using-the-dynamically-linked-wkhtmltopdf-binary" class="anchor" href="#using-the-dynamically-linked-wkhtmltopdf-binary"><span class="octicon octicon-link"></span></a>Using the dynamically linked wkhtmltopdf binary</h2>

<p>WORK IN PROGRESS:</p>

<p>On some linux distributions <code>wkhtmltopdf</code> is available as a package. But unfortunately only the
dynamically linked binary is included, so you need an xvfb server to create PDFs. We have
included two workarounds for this: Either start an xvfb server from an init script (recommended)
or let the wrapper fire up an X buffer for each PDF created.</p>

<h3>
<a name="init-script-for-xvfb" class="anchor" href="#init-script-for-xvfb"><span class="octicon octicon-link"></span></a>Init script for xvfb</h3>

<p>You can use a init script as described <a href="https://coderwall.com/p/tog9eq">here</a> (Thanks to Larry Williamson). You can leave out the step where you  have to change the class. Instaed you can supply the display configuration in <code>procEnv</code>:</p>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WkHtmlToPdf</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'procEnv'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'DISPLAY'</span> <span class="o">=&gt;</span> <span class="s1">':0'</span> <span class="p">),</span>
<span class="p">));</span>
</pre></div>

<h3>
<a name="autostart-xvfb-for-each-pdf" class="anchor" href="#autostart-xvfb-for-each-pdf"><span class="octicon octicon-link"></span></a>Autostart xvfb for each PDF</h3>

<p>WIP</p>

<h2>
<a name="note-for-windows-users" class="anchor" href="#note-for-windows-users"><span class="octicon octicon-link"></span></a>Note for Windows users</h2>

<p>If you use double quotes (<code>"</code>) or percent signs (<code>%</code>) as option values, they may get converted to spaces. You can set <code>enableEscaping</code> to false in this case. But then you have to take care of proper escaping yourself. In some cases it may be neccessary to surround your argument values with extra double quotes.</p>

<p>I also found that some options don't work on Windows (tested with wkhtmltopdf 0.11 rc2), like the <code>user-style-sheet</code> option described below.</p>

<h2>
<a name="full-example" class="anchor" href="#full-example"><span class="octicon octicon-link"></span></a>Full example</h2>

<p>For me <code>wkhtmltopdf</code> seems to create best results with smart shrinking turned off. 
But then i had scaling issues which went away if i set all margins to zero and instead
add the margins through CSS. We can also use <code>cm</code> in CSS as this is more apropriate for print styles.</p>

<div class="highlight highlight-php"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1">// Create a new WKHtmlToPdf object with some global PDF options</span>
<span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WkHtmlToPdf</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'no-outline'</span><span class="p">,</span>         <span class="c1">// Make Chrome not complain</span>
    <span class="s1">'margin-top'</span>    <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'margin-right'</span>  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'margin-bottom'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">'margin-left'</span>   <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">));</span>

<span class="c1">// Set default page options for all following pages</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">setPageOptions</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'disable-smart-shrinking'</span><span class="p">,</span>
    <span class="s1">'user-style-sheet'</span> <span class="o">=&gt;</span> <span class="s1">'pdf.css'</span><span class="p">,</span>
<span class="p">));</span>

<span class="c1">// Add a page. To override above page defaults, you could add </span>
<span class="c1">// another $options array as second argument.</span>
<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">addPage</span><span class="p">(</span><span class="s1">'demo.html'</span><span class="p">);</span>

<span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>

<p><strong>demo.html</strong></p>

<div class="highlight highlight-html"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"print-area"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"header"</span><span class="nt">&gt;</span>
            This is an example header.
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;p&gt;</span>This is example content<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
            This is an example footer.
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p><strong>pdf.css</strong></p>

<div class="highlight highlight-css"><pre><span class="c">/* Define page size. Requires print-area adjustment! */</span>
<span class="nt">body</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span>     <span class="m">0</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span>    <span class="m">0</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span>      <span class="m">21cm</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span>     <span class="m">29.7cm</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Printable area */</span>
<span class="nf">#print-area</span> <span class="p">{</span>
    <span class="k">position</span><span class="o">:</span>   <span class="k">relative</span><span class="p">;</span>
    <span class="k">top</span><span class="o">:</span>        <span class="m">1cm</span><span class="p">;</span>
    <span class="k">left</span><span class="o">:</span>       <span class="m">1cm</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span>      <span class="m">19cm</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span>     <span class="m">27.6cm</span><span class="p">;</span>

    <span class="k">font-size</span><span class="o">:</span>      <span class="m">10px</span><span class="p">;</span>
    <span class="k">font-family</span><span class="o">:</span>    <span class="n">Arial</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#header</span> <span class="p">{</span>
    <span class="k">height</span><span class="o">:</span>     <span class="m">3cm</span><span class="p">;</span>

    <span class="k">background</span><span class="o">:</span> <span class="m">#ccc</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#footer</span> <span class="p">{</span>
    <span class="k">position</span><span class="o">:</span>   <span class="k">absolute</span><span class="p">;</span>
    <span class="k">bottom</span><span class="o">:</span>     <span class="m">0</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span>      <span class="m">100</span><span class="o">%</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span>     <span class="m">3cm</span><span class="p">;</span>

    <span class="k">background</span><span class="o">:</span> <span class="m">#ccc</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">PHP WkHtmlToPdf maintained by <a href="https://github.com/mikehaertl">mikehaertl</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-31221500-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
